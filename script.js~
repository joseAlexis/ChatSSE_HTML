if(typeof(EventSource)!=="undefined")
{
	var source=new EventSource("chat.php");
  	
  	source.onmessage=function(event){
  		var contenido = event.data.split("/**fin**/");
  		document.getElementById("txtChat").innerHTML = "";
  		
  		for (var i = 0; i <= contenido.length - 1; i++) {		  					
			document.getElementById("txtChat").innerHTML += contenido[i] + "\n";
		}
   };
   
}
else 
{
	document.getElementById("txtChat").innerHTML="Lo sentimos, su navegador no soporta el SSE (Server Sent Events)";
}



/*----------------Funcion que valida que no hallan palabras vulgares----------------*/
function validarPalabras() {	
	var sentencia = document.getElementById("txtTexto").value;
	/*var nombreUsuario = validarUsuario();*/
	var resultado = new Array();	
	resultado = sentencia.split(" ");
	
	var palabrasReservadas = new Array("picha", "hijueputa", "mierda", "malparido", "playo", "loca", "cagon", "gay", "puto", "puta", "putas");
	
	var nuevaSentencia = "";
	
	/*var nuevaSentencia = nombreUsuario+": ";*/
	
	
	for (var i = 0; i < resultado.length; i++) 
	{
		for (var j = 0; j < palabrasReservadas.length; j++) 
		{
				if(resultado[i] == palabrasReservadas[j])
				{
					resultado[i] = "*censurado*";
				}
		}
		nuevaSentencia += resultado[i] + " ";
	}
	ultimoMensaje = nuevaSentencia;
	
	//alert(ultimoMensaje);
	
	document.getElementById("txtTexto").value = nuevaSentencia;
}